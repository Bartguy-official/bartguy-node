Vanadium={};Vanadium.Version="0.1";Vanadium.CompatibleWithJQuery="1.3.2";Vanadium.Type="jquery";if($().jquery.indexOf(Vanadium.CompatibleWithJQuery)!=0&&window.console&&window.console.warn){console.warn("This version of Vanadium is tested with jQuery "+Vanadium.CompatibleWithJQuery+" it may not work as expected with this version ("+$().jquery+")")}Vanadium.each=$.each;Vanadium.all_elements=function(){return $("*")};Vanadium.partition=function(e,g){var h=[];var f=[];Vanadium.each(e,function(){if(g(this)){h.push(this)}else{f.push(this)}});return[h,f]};var HashMap=function(){this.initialize()};HashMap.prototype={hashkey_prefix:"<#HashMapHashkeyPerfix>",hashcode_field:"<#HashMapHashcodeField>",hashmap_instance_id:0,initialize:function(){this.backing_hash={};this.code=0;this.hashmap_instance_id+=1;this.instance_id=this.hashmap_instance_id},hashcodeField:function(){return this.hashcode_field+this.instance_id},put:function(e,g){var h;if(e&&g){var f;if(typeof(e)==="number"||typeof(e)==="string"){f=e}else{f=e[this.hashcodeField()]}if(f){h=this.backing_hash[f]}else{this.code+=1;f=this.hashkey_prefix+this.code;e[this.hashcodeField()]=f}this.backing_hash[f]=[e,g]}return h===undefined?undefined:h[1]},get:function(d){var f;if(d){var e;if(typeof(d)==="number"||typeof(d)==="string"){e=d}else{e=d[this.hashcodeField()]}if(e){f=this.backing_hash[e]}}return f===undefined?undefined:f[1]},del:function(e){var g=false;if(e){var f;if(typeof(e)==="number"||typeof(e)==="string"){f=e}else{f=e[this.hashcodeField()]}if(f){var h=this.backing_hash[f];this.backing_hash[f]=undefined;if(h!==undefined){e[this.hashcodeField()]=undefined;g=true}}}return g},each:function(f,e){var d;for(d in this.backing_hash){if(f.call(this.backing_hash[d][1],this.backing_hash[d][0],this.backing_hash[d][1])===false){break}}return this},toString:function(){return"HashMapJS"}};Vanadium.containers=new HashMap();var ContainerValidation=function(b){this.initialize(b)};ContainerValidation.prototype={initialize:function(b){this.html_element=b;this.elements=[]},add_element:function(b){this.elements.push(b)},decorate:function(){var d=null;for(var c in this.elements){if(this.elements[c].invalid===undefined){d=undefined}else{if(this.elements[c].invalid===true){d=false;break}else{if(this.elements[c].invalid===false&&d===null){d=true}}}}if(d===undefined){$(this.html_element).removeClass(Vanadium.config.invalid_class);$(this.html_element).removeClass(Vanadium.config.valid_class)}else{if(d){$(this.html_element).removeClass(Vanadium.config.invalid_class);$(this.html_element).addClass(Vanadium.config.valid_class)}else{$(this.html_element).removeClass(Vanadium.config.valid_class);$(this.html_element).addClass(Vanadium.config.invalid_class)}}}};var VanadiumForm=function(b){this.initialize(b)};Vanadium.forms=new HashMap();VanadiumForm.add_element=function(d){var f=d.element.form;if(f){var e=Vanadium.forms.get(f);if(e){e.validation_elements.push(d)}else{e=new VanadiumForm(d);Vanadium.forms.put(f,e)}}};VanadiumForm.prototype={initialize:function(d){this.validation_elements=[d];this.form=d.element.form;var c=this;$(this.form).submit(function(){var b=c.validate();var a=true;b.each(function(i,j){for(var h in j){if(j[h].success==false){a=false;break}}if(a==false){return false}});if(!a){c.decorate();return false}});this.form.decorate=function(){c.decorate()}},validate:function(){var b=new HashMap();Vanadium.each(this.validation_elements,function(){b.put(this,this.validate())});return b},decorate:function(b){if(arguments.length==0){b=this.validate()}b.each(function(a,d){a.decorate(d)})}};Vanadium.validators_types={};Vanadium.elements_validators_by_id={};Vanadium.created_advices=[];Vanadium.config={valid_class:"vanadium-valid",invalid_class:"vanadium-invalid",message_value_class:"vanadium-message-value",advice_class:"vanadium-advice",prefix:":",separator:";",reset_defer_timeout:100};Vanadium.empty_advice_marker_class="-vanadium-empty-advice-";Vanadium.rules={};Vanadium.init=function(){this.setupValidatorTypes();this.scan_dom()};Vanadium.addValidatorType=function(j,g,f,i,h){this.validators_types[j]=new Vanadium.Type(j,g,f,i,h)};Vanadium.addValidatorTypes=function(c){var d=this;Vanadium.each(c,function(){Vanadium.addValidatorType.apply(d,this)})};Vanadium.scan_dom=function(){Vanadium.each(Vanadium.all_elements(),function(e,g){var h=g.className.split(" ");if(Vanadium.is_input_element(g)){var f=new ElementValidation(g);if(g.id){Vanadium.elements_validators_by_id[g.id]=f}VanadiumForm.add_element(f);Vanadium.each(h,function(){var a=Vanadium.parse_class_name(this);if(a){Vanadium.add_validation_instance(f,a);Vanadium.add_validation_modifier(f,a)}});Vanadium.each(Vanadium.get_rules(g.id),function(){var a=this;if(a){Vanadium.add_validation_instance(f,a);Vanadium.add_validation_modifier(f,a)}});f.setup()}else{Vanadium.add_validation_container(g)}})};Vanadium.add_validation_container=function(d){var c=d.className.split(" ");Vanadium.each(c,function(){var a=Vanadium.parse_class_name(this);if(a[0]=="container"){Vanadium.containers.put(d,new ContainerValidation(d));return true}});Vanadium.each(Vanadium.get_rules(d.id),function(){var a=this;if(a=="container"){Vanadium.containers.put(d,new ContainerValidation(d));return true}})};Vanadium.get_rules=function(g){var i=function(a){if(typeof a==="string"){return[a]}else{if(Vanadium.isArray(a)){return a}else{if(typeof(a)==="object"){return[a.validator,a.parameter,a.advice]}else{return undefined}}}};var h=[];var f=Vanadium.rules[g];if(typeof f==="undefined"){return[]}else{if(typeof f==="string"){h.push(f)}else{if(Vanadium.isArray(f)){for(var j in f){h.push(i(f[j]))}}else{if(typeof(f)==="object"){h.push(i(f))}}}}return h};Vanadium.parse_class_name=function(f){if(f.indexOf(Vanadium.config.prefix)==0){var e=f.substr(Vanadium.config.prefix.length).split(Vanadium.config.separator);for(var d in e){if(e[d]==""){e[d]=undefined}}return e}else{return[]}};Vanadium.add_validation_instance=function(h,j){var k=j[0];var i=j[1];var g=j[2];var l=Vanadium.validators_types[k];if(l){h.add_validation_instance(l,i,g)}};Vanadium.add_validation_modifier=function(f,g){var h=g[0];var e=g[1];if(h=="only_on_blur"||h=="only_on_submit"||h=="wait"||h=="advice"){f.add_validation_modifier(h,e)}};Vanadium.validate=function(){var b=new HashMap();Vanadium.each(this.elements_validators,function(){b.put(this.element,this.validate())});return b};Vanadium.decorate=function(d){if(typeof d==="object"){if(d.toString()=="HashMapJS"){d.each(function(b,a){b.decorate(a)})}else{var e;for(e in d){var f=Vanadium.elements_validators_by_id[e];if(f){f.decorate(d[e])}}}}};Vanadium.reset=function(){Vanadium.each(this.elements_validators,function(){this.reset()})};Vanadium.isArray=function(b){return b!=null&&typeof b=="object"&&"splice" in b&&"join" in b};Vanadium.isFunction=function(b){return b!=null&&b.toString()==="[object Function]"};Vanadium.extend=function(f){var d=[Vanadium];for(var e=0;e<arguments.length;e++){d.push(arguments[e])}return $.extend.apply($,d)};Vanadium.bind=function(d,c){return function(){return d.apply(c,arguments)}};Vanadium.extend({getElementType:function(b){switch(true){case (b.nodeName.toUpperCase()=="TEXTAREA"):return Vanadium.TEXTAREA;case (b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="TEXT"):return Vanadium.TEXT;case (b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="PASSWORD"):return Vanadium.PASSWORD;case (b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="CHECKBOX"):return Vanadium.CHECKBOX;case (b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="FILE"):return Vanadium.FILE;case (b.nodeName.toUpperCase()=="SELECT"):return Vanadium.SELECT;case (b.nodeName.toUpperCase()=="INPUT"):throw new Error("Vanadium::getElementType - Cannot use Vanadium on an "+b.type+" input!");default:throw new Error("Vanadium::getElementType - Element must be an input, select, or textarea!")}},is_input_element:function(b){return(b.nodeName.toUpperCase()=="TEXTAREA")||(b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="TEXT")||(b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="PASSWORD")||(b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="CHECKBOX")||(b.nodeName.toUpperCase()=="INPUT"&&b.type.toUpperCase()=="FILE")||(b.nodeName.toUpperCase()=="SELECT")},createAdvice:function(j,f,i){var g=document.createElement("span");g.id=f;var h=document.createTextNode(i);g.appendChild(h);j.parentNode.insertBefore(g,j.nextSibling);this.created_advices.push(g)},addValidationClass:function(d,c){if(d){this.removeValidationClass(d);if(c){d.className+=" "+Vanadium.config.valid_class}else{d.className+=" "+Vanadium.config.invalid_class}}},removeValidationClass:function(b){if(b){if(b.className.indexOf(Vanadium.config.invalid_class)!=-1){b.className=b.className.split(Vanadium.config.invalid_class).join(" ")}if(b.className.indexOf(Vanadium.config.valid_class)!=-1){b.className=b.className.split(Vanadium.config.valid_class).join(" ")}}},TEXTAREA:1,TEXT:2,PASSWORD:3,CHECKBOX:4,SELECT:5,FILE:6});ElementValidation=function(b){this.initialize(b)};ElementValidation.prototype={initialize:function(b){this.virgin=true;this.element=b;this.validations=[];this.only_on_blur=false;this.only_on_submit=false;this.wait=100;this.created_advices=[];this.decorated=false;this.containers=null;this.invalid=undefined;this.advice_id=undefined},add_validation_instance:function(d,f,e){this.validations.push(new Validation(this.element,d,f,e))},add_validation_modifier:function(f,g){if(f=="only_on_blur"){this.only_on_blur=true}else{if(f=="only_on_submit"){this.only_on_submit=true}else{if(f=="wait"){var e=parseInt(g);if(e!=NaN&&typeof(e)==="number"){this.wait=e}}else{if(f=="advice"){var h=document.getElementById(g);if(h){this.advice_id=g}}}}}},element_containers:function(){if(this.containers===null){this.containers=new HashMap();var c=this.element.parentNode;while(c!=document){var d=Vanadium.containers.get(c);if(d){d.add_element(this);this.containers.put(c,d)}c=c.parentNode}}return this.containers},validate:function(d,f){var e=[];Vanadium.each(this.validations,function(){e.push(this.validate(d,f))});return e},decorate:function(i,k){if(!k){this.reset()}this.decorated=true;var l=this;var g=Vanadium.partition(i,function(a){return a.success});var j=g[0];var h=g[1];if(h.length>0){this.invalid=true;Vanadium.addValidationClass(this.element,false)}else{if(j.length>0&&!this.invalid){this.invalid=false;Vanadium.addValidationClass(this.element,true)}else{this.invalid=undefined}}this.element_containers().each(function(a,b){b.decorate()});Vanadium.each(h,function(c,a){var b=undefined;if(l.advice_id){b=document.getElementById(l.advice_id)}if(b||a.advice_id){b=b||document.getElementById(a.advice_id);if(b){$(b).addClass(Vanadium.config.advice_class);var d=b.childNodes.length==0;if(d||$(b).hasClass(Vanadium.empty_advice_marker_class)){$(b).addClass(Vanadium.empty_advice_marker_class);$(b).append("<span>"+a.message+"</span>")}$(b).show()}else{b=l.create_advice(a)}}else{b=l.create_advice(a)}Vanadium.addValidationClass(b,false)})},validateAndDecorate:function(){if(!this.virgin){this.decorate(this.validate(this,this.decorate))}},create_advice:function(c){var d=document.createElement("span");this.created_advices.push(d);$(d).addClass(Vanadium.config.advice_class);$(d).html(c.message);$(this.element).after(d);return d},reset:function(){this.invalid=undefined;var c=document.getElementById(this.advice_id);if(c){if($(c).hasClass(Vanadium.empty_advice_marker_class)){$(c).empty()}$(c).hide()}Vanadium.each(this.validations,function(){var a=document.getElementById(this.adviceId);if(a){if($(a).hasClass(Vanadium.empty_advice_marker_class)){$(a).empty()}$(a).hide()}});var d=this.created_advices.pop();while(!(d===undefined)){$(d).remove();d=this.created_advices.pop()}Vanadium.removeValidationClass(this.element)},deferValidation:function(){if(this.wait>=300){this.reset()}var b=this;if(b.timeout){clearTimeout(b.timeout)}b.timeout=setTimeout(function(){$(b.element).trigger("validate")},b.wait)},deferReset:function(){var b=this;if(b.reset_timeout){clearTimeout(b.reset_timeout)}b.reset_timeout=setTimeout(function(){b.reset()},Vanadium.config.reset_defer_timeout)},setup:function(){var b=this;this.elementType=Vanadium.getElementType(this.element);this.form=this.element.form;this.element_containers();if(!this.only_on_submit){this.observe();$(b.element).bind("validate",function(){b.validateAndDecorate.call(b)});$(b.element).bind("defer_validation",function(){b.deferValidation.call(b)});$(b.element).bind("reset",function(){b.reset.call(b)})}},observe:function(){var f=this.element;var d=Vanadium.getElementType(f);var e=this;$(f).focus(function(){e.virgin=false});switch(d){case Vanadium.CHECKBOX:$(f).click(function(){e.virgin=false;$(e.element).trigger("validate")});break;case Vanadium.SELECT:case Vanadium.FILE:$(f).change(function(){$(f).trigger("validate")});break;default:$(f).keydown(function(a){if(a.keyCode!=9){$(f).trigger("reset")}});if(!this.only_on_blur){$(f).keyup(function(a){if(a.keyCode!=9){$(f).trigger("defer_validation")}})}$(f).blur(function(){$(f).trigger("validate")})}}};var Validation=function(h,f,g,e){this.initialize(h,f,g,e)};Validation.prototype={initialize:function(i,g,h,j){this.element=i;this.validation_type=g;this.param=h;this.adviceId=j;var f=document.getElementById(j);if(f){$(f).addClass(Vanadium.config.advice_class)}if(this.validation_type.init){this.validation_type.init(this)}},emmit_message:function(b){if(typeof(b)==="string"){return b}else{if(typeof(b)==="function"){return b.call(this,$(this.element).val(),this.param)}}},validMessage:function(){return this.emmit_message(this.validation_type.validMessage())||"ok"},invalidMessage:function(){return this.emmit_message(this.validation_type.invalidMessage())||"error"},test:function(d,c){return this.validation_type.validationFunction.call(this,$(this.element).val(),this.param,this,d,c)},validate:function(e,g){var f={success:false,message:"Received invalid return value."};var h=this.test(e,g);if(typeof h==="boolean"){return{success:h,advice_id:this.adviceId,message:(h?this.validMessage():this.invalidMessage())}}else{if(typeof h==="object"){$.extend.apply(f,h)}}return f}};Vanadium.Type=function(j,g,f,i,h){this.initialize(j,g,f,i,h)};Vanadium.Type.prototype={initialize:function(j,g,f,i,h){this.className=j;this.message=i;this.error_message=f;this.validationFunction=g;this.init=h},test:function(b){return this.validationFunction.call(this,b)},validMessage:function(){return this.message},invalidMessage:function(){return this.error_message},toString:function(){return"className:"+this.className+" message:"+this.message+" error_message:"+this.error_message},init:function(b){if(this.init){this.init(b)}}};Vanadium.setupValidatorTypes=function(){Vanadium.addValidatorType("empty",function(b){return((b==null)||(b.length==0))});Vanadium.addValidatorTypes([["equal",function(d,c){return d==c},function(d,c){return'The value should be equal to <span class="'+Vanadium.config.message_value_class+'">'+c+"</span>."}],["equal_ignore_case",function(d,c){return d.toLowerCase()==c.toLowerCase()},function(d,c){return'The value should be equal to <span class="'+Vanadium.config.message_value_class+'">'+c+"</span>."}],["required",function(b){return !Vanadium.validators_types.empty.test(b)},"This is a required field."],["accept",function(d,e,f){return f.element.checked},"Must be accepted!"],["integer",function(d){if(Vanadium.validators_types.empty.test(d)){return true}var c=parseFloat(d);return(!isNaN(c)&&c.toString()==d&&Math.round(c)==c)},"Please enter a valid integer in this field."],["number",function(b){return Vanadium.validators_types.empty.test(b)||(!isNaN(b)&&!/^\s+$/.test(b))},"Please enter a valid number in this field."],["float",function(b){return Vanadium.validators_types.empty.test(b)||(!isNaN(b)&&!/^\s+$/.test(b))},"Please enter a valid number in this field."],["digits",function(b){return Vanadium.validators_types.empty.test(b)||!/[^\d]/.test(b)},"Please use numbers only in this field. please avoid spaces or other characters such as dots or commas."],["alpha",function(b){return Vanadium.validators_types.empty.test(b)||/^[a-zA-Z\u00C0-\u00FF\u0100-\u017E\u0391-\u03D6]+$/.test(b)},"Please use letters only in this field."],["asciialpha",function(b){return Vanadium.validators_types.empty.test(b)||/^[a-zA-Z]+$/.test(b)},"Please use ASCII letters only (a-z) in this field."],["alphanum",function(b){return Vanadium.validators_types.empty.test(b)||!/\W/.test(b)},"Please use only letters (a-z) or numbers (0-9) only in this field. No spaces or other characters are allowed."],["date",function(d){var c=new Date(d);return Vanadium.validators_types.empty.test(d)||!isNaN(c)},"Please enter a valid date."],["email",function(b){return(Vanadium.validators_types.empty.test(b)||/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/.test(b))},"Please enter a valid email address. For example fred@domain.com ."],["url",function(b){return Vanadium.validators_types.empty.test(b)||/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(b)},"Please enter a valid URL."],["date_au",function(e){if(Vanadium.validators_types.empty.test(e)){return true}var d=/^(\d{2})\/(\d{2})\/(\d{4})$/;if(!d.test(e)){return false}var f=new Date(e.replace(d,"$2/$1/$3"));return(parseInt(RegExp.$2,10)==(1+f.getMonth()))&&(parseInt(RegExp.$1,10)==f.getDate())&&(parseInt(RegExp.$3,10)==f.getFullYear())},"Please use this date format: dd/mm/yyyy. For example 17/03/2006 for the 17th of March, 2006."],["currency_dollar",function(b){return Vanadium.validators_types.empty.test(b)||/^\$?\-?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}\d*(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$/.test(b)},"Please enter a valid $ amount. For example $100.00 ."],["selection",function(d,c){return c.options?c.selectedIndex>0:!Vanadium.validators_types.empty.test(d)},"Please make a selection"],["one_required",function(e,f){var d=$$('input[name="'+f.name+'"]');return some(d,function(a){return getNodeAttribute(a,"value")})},"Please select one of the above options."],["length",function(d,c){if(c===undefined){return true}else{return d.length==parseInt(c)}},function(d,c){return'The value should be <span class="'+Vanadium.config.message_value_class+'">'+c+"</span> characters long."}],["min_length",function(d,c){if(c===undefined){return true}else{return d.length>=parseInt(c)}},function(d,c){return'The value should be at least <span class="'+Vanadium.config.message_value_class+'">'+c+"</span> characters long."}],["max_length",function(d,c){if(c===undefined){return true}else{return d.length<=parseInt(c)}},function(d,c){return'The value should be at most <span class="'+Vanadium.config.message_value_class+'">'+c+"</span> characters long."}],["same_as",function(d,f){if(f===undefined){return true}else{var e=document.getElementById(f);if(e){return d==e.value}else{return false}}},function(d,f){var e=document.getElementById(f);if(e){return'The value should be the same as <span class="'+Vanadium.config.message_value_class+'">'+($(e).attr("name")||e.id)+"</span> ."}else{return"There is no exemplar item!!!"}},"",function(c){var d=document.getElementById(c.param);if(d){$(d).bind("validate",function(){$(c.element).trigger("validate")})}}],["ajax",function(g,i,j,f,h){if(Vanadium.validators_types.empty.test(g)){return true}if(f&&h){$.getJSON(i,{value:g,id:j.element.id},function(a){h.apply(f,[[a],true])})}return true}],["format",function(h,l){var j=l.split("/");if(j.length==3&&j[0]==""){var m=j[1];var i=j[2];try{var k=new RegExp(m,i);return k.test(h)}catch(n){return false}}else{return false}},function(e,d){var f=d.split("/");if(f.length==3&&f[0]==""){return'The value should match the <span class="'+Vanadium.config.message_value_class+'">'+d.toString()+"</span> pattern."}else{return'provided parameter <span class="'+Vanadium.config.message_value_class+'">'+d.toString()+"</span> is not valid Regexp pattern."}}]]);if(typeof(VanadiumCustomValidationTypes)!=="undefined"&&VanadiumCustomValidationTypes){Vanadium.addValidatorTypes(VanadiumCustomValidationTypes)}};$(document).ready(function(){if(typeof(VanadiumConfig)==="object"&&VanadiumConfig){Vanadium.each(VanadiumConfig,function(c,d){Vanadium.config[c]=d})}if(typeof(VanadiumRules)==="object"&&VanadiumRules){Vanadium.each(VanadiumRules,function(c,d){Vanadium.rules[c]=d})}Vanadium.init()});